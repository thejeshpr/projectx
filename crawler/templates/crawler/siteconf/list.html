{% extends 'crawler/base.html' %}

{% load bootstrap5 %}

{% block content %}
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Site Configuration</th>
                <th>Grabber</th>
                <th>Enabled</th>
                <th>Is Locked</th>
                <th>Jobs</th>
                <th>Tasks</th>
                <th>Last Sync Time</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for site_conf in site_confs %}
            <tr>
                <td>
                    <a href="{% url 'crawler:siteconf-detail' site_conf.pk %}">
                        {{ site_conf.pk }}::{{ site_conf.name }}
                    </a>
                </td>
                <td>{{ site_conf.scraper_name }}</td>
                <td>{{ site_conf.enabled }}</td>
                <td>{{ site_conf.is_locked }}</td>
                <td><a href="{% url 'crawler:siteconf-jobs' site_conf.pk %}">{{ site_conf.jobs.count }}</a></td>
                <td>{{ site_conf.tasks.count }}</td>
                <td>
                    {% if site_conf.jobs.last %}
                        <a href="{% url 'crawler:job-detail' site_conf.jobs.last.pk %}">
                            {{ site_conf.jobs.last.created_at }}
                        </a>
                    {% else %}
                        Never
                    {% endif %}
                </td>
                <td>
                    <div class="btn-group" role="group">
                        <a class="btn btn-sm btn-success" href="{% url 'crawler:scrape' site_conf.pk %}?redirect_to_job=yes" target="_blank">Sync</a>
                        <a class="btn btn-sm btn-primary" href="{% url 'crawler:siteconf-edit' site_conf.pk %}">Edit</a>
<!--                        <a class="btn btn-sm btn-secondary" href="{% url 'crawler:siteconf-jobs' site_conf.pk %}">Jobs</a>-->
                        <a class="btn btn-sm btn-danger" href="{% url 'crawler:siteconf-delete' site_conf.pk %}">Delete</a>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% include "crawler/generic/pagination.html" %}

{% endblock %}
